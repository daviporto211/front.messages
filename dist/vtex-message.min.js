!function(){var a,b,c,d=function(a,b){return function(){return a.apply(b,arguments)}};c="undefined"!=typeof exports&&null!==exports?exports:window,window.vtex||(window.vtex={}),a=function(){function a(a){var b,c,e,f=this;if(null==a&&(a={}),this.hide=d(this.hide,this),this.show=d(this.show,this),this.classes={TEMPLATEDEFAULT:".vtex-message-template.vtex-message-template-default",MODALTEMPLATEDEFAULT:".vtex-message-template.vtex-message-template-modal-default",PLACEHOLDER:".vtex-message-placeholder",MODALPLACEHOLDER:"body",TEMPLATE:"vtex-message-template",TITLE:".vtex-message-title",DETAIL:".vtex-message-detail",TYPE:"alert-",MESSAGEINSTANCE:"vtex-message-instance"},b={id:_.uniqueId("vtex-message-"),placeholder:this.classes.PLACEHOLDER,modalPlaceholder:this.classes.MODALPLACEHOLDER,template:this.classes.TEMPLATE,modalTemplate:this.classes.MODALTEMPLATE,prefixClassForType:this.classes.TYPE,content:{title:"",detail:""},type:"info",visible:!1,usingModal:!1,domElement:$(),insertMethod:"append"},_.extend(this,b,a),e='<div class="vtex-message-template vtex-message-template-modal-default modal hide fade">\n	<div class="modal-header">\n		<h3 class="vtex-message-title"></h3>\n	</div>\n	<div class="modal-body">\n		<p class="vtex-message-detail"></p>\n	</div>\n	<div class="modal-footer">\n		<button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>\n	</div>\n</div>',c='<div class="vtex-message-template vtex-message-template-default static-message-template alert">\n	<button type="button" class="close" data-dismiss="alert">&times;</button>\n	<h4 class="alert-heading vtex-message-title"></h4>\n	<p class="message-text vtex-message-detail"></p>\n</div>',"fatal"===this.type&&(this.usingModal=!0),this.usingModal){if(!$(this.modalPlaceholder)[0])throw new Error("Couldn't find placeholder for modal Message");if(this.modalTemplate===this.classes.MODALTEMPLATE)this.modalTemplate=e;else if(!$(this.modalTemplate)[0])throw new Error("Couldn't find specified template for modal Message");this.domElement=$(this.modalTemplate)}else{if(!$(this.placeholder)[0])throw new Error("Couldn't find placeholder for Message");if(this.template===this.classes.TEMPLATE)this.template=c;else if(!$(this.template)[0])throw new Error("Couldn't find specified template for Message");this.domElement=$(this.template).clone(!1,!1),$(this.domElement).bind("closed",function(){return f.visible=!1})}$(this.domElement).removeClass(this.classes.TEMPLATE),$(this.domElement).addClass(this.prefixClassForType+this.type+" "+this.id+" "+this.classes.MESSAGEINSTANCE),$(this.domElement).hide(),$(this.domElement).data("vtex-message",this),this.content.title&&""!==this.content.title?$(this.classes.TITLE,this.domElement).html(this.content.title):$(this.classes.TITLE,this.domElement).hide(),$(this.classes.DETAIL,this.domElement).html(this.content.detail),this.usingModal?($(this.domElement).on("hidden",function(){return f.visible=!1}),$(this.modalPlaceholder).append(this.domElement)):$(this.placeholder)[this.insertMethod](this.domElement),this.visible&&this.show()}return a.prototype.show=function(a){var b,c,d,e,f,g,h,i,j,k,l,m=this;if(this.usingModal){if("object"==typeof a)for(k=["show","shown","hide","hidden"],g=0,i=k.length;i>g;g++)b=k[g],"function"==typeof a[b]&&function(b){return $(m.domElement).on(b,function(){return a[b](m)})}(b);for(c=!1,l=$(".modal."+this.classes.MESSAGEINSTANCE),h=0,j=l.length;j>h;h++)d=l[h],e=$(d).data("vtex-message"),e.visible===!0&&e.domElement!==this.domElement[0]&&(c=!0,$(d).one("hidden",function(){return $(m.domElement).modal("show"),m.visible=!0}));return c||($(this.domElement).on("show",function(){return m.visible=!0}),$(this.domElement).modal("show")),void 0}return"object"==typeof a&&null!=a.complete&&"function"==typeof a.complete?(f=a.complete,a.complete=function(){return m.visible=!0,f(m)},this.domElement.fadeIn(a)):"number"==typeof a?this.domElement.fadeIn(a,function(){return m.visible=!0}):(this.domElement.show(),this.visible=!0)},a.prototype.hide=function(a){var b,c=this;return this.usingModal?(this.domElement.modal("hide"),this.visible=!1,void 0):"object"==typeof a&&null!=a.complete&&"function"==typeof a.complete?(b=a.complete,a.complete=function(){return c.visible=!1,b(c)},this.domElement.fadeOut(a)):"number"==typeof a?this.domElement.fadeOut(a,function(){return c.visible=!1}):(this.domElement.hide(),this.visible=!1)},a}(),b=function(){function b(a){var b;null==a&&(a={}),this.removeMessage=d(this.removeMessage,this),this.addMessage=d(this.addMessage,this),b={ajaxError:!1,messagesArray:[]},_.extend(this,b,a),this.ajaxError&&this.bindAjaxError()}var c;return b.prototype.addMessage=function(b,c){var d;return null==c&&(c=!1),d=new a(b),this.messagesArray.push(d),c!==!1&&d.show(c),d},b.prototype.removeMessage=function(a){var b,c,d,e,f,g,h,i,j;for(e=_.where(this.messagesArray,a),j=this.messagesArray,b=f=0,h=j.length;h>f;b=++f)for(c=j[b],g=0,i=e.length;i>g;g++)if(d=e[g],c.id===d.id)return c.domElement.remove(),this.messagesArray.splice(b,1),void 0},b.prototype.bindAjaxError=function(){var a=this;return $(document).ajaxError(function(b,d){var e,f,g,h,i,j,k,l,m,n;return 401!==d.status&&403!==d.status&&0!==d.readyState&&0!==d.status?(window.i18n?(h=window.i18n.t("global.unkownError"),g=window.i18n.t("global.error")):(h="An unexpected error ocurred.",g="Error"),d.getResponseHeader("x-vtex-operation-id")&&(g+=' <small class="vtex-operation-id-container">(Operation ID ',g+='<span class="vtex-operation-id">',g+=decodeURIComponent(d.getResponseHeader("x-vtex-operation-id")),g+="</span>",g+=")</small>"),d.getResponseHeader("x-vtex-error-message")?(j=-1!==(null!=(m=d.getResponseHeader("Content-Type"))?m.indexOf("application/json"):void 0),j&&null!=(null!=(n=d.responseText.error)?n.message:void 0)?f=decodeURIComponent(d.responseText.error.message):(f=decodeURIComponent(d.getResponseHeader("x-vtex-error-message")),l="Value=1"===c("ShowFullError"),l&&(f+='<div class="vtex-error-detail-container">\n	<a href="javascript:void(0);" class="vtex-error-detail-link" onClick="$(\'.vtex-error-detail\').show()">\n		<small>Details</small>\n	</a>\n	<div class="vtex-error-detail" style="display: none;"></div>\n</div>',i=document.createElement("iframe"),i.src="data:text/html;charset=utf-8,"+decodeURIComponent(d.responseText),$(i).css("width","100%"),$(i).css("height","900px"),e=!0))):f=h,k={type:"fatal",content:{title:g,detail:f}},a.addMessage(k,!0),e?($(".vtex-error-detail").html(i),e=null):void 0):void 0})},c=function(a){var b,c,d,e;if(c=null,document.cookie&&""!==document.cookie)for(d=document.cookie.split(";"),e=0;e<d.length;){if(b=(d[e]||"").replace(/^\s+|\s+$/g,""),b.substring(0,a.length+1)===a+"="){c=decodeURIComponent(b.substring(a.length+1));break}e++}return c},b}(),c.vtex.Messages=b}.call(this);